# 重跑对比预测

**时间**: 2025-11-12 22:46
**状态**: 2X-NH2运行中

---

## 1X库验证结果（已完成）

### Flavone-1X-OMe vs Flavone-1X-NH2

| 指标 | OMe | NH2 | 差异 |
|------|-----|-----|------|
| total_input | 241,966 | 241,966 | 0 |
| total_processed | 892,257 | 892,257 | **0** ✅ |
| unique_products | 843,939 | 843,939 | **0** ✅ |
| fail_no_matching_sites | 24,436 | 24,436 | 0 |
| workers | 8 | 8 | ✅ |
| max_sites_per_mol | -1 | -1 | ✅ |
| elapsed_seconds | 888.6s | 884.1s | ~相同 |

**结论**: 用一致参数后，**OMe和NH2产生完全相同的产物数量**！

---

## 2X库对比预测

### 旧数据（不一致配置）

| 指标 | OMe (旧) | NH2 (旧) | 差异 |
|------|----------|----------|------|
| total_input | 4,861,369 | 4,861,369 | 0 |
| total_processed | 26,984,387 | 20,023,649 | **+6,960,738 (+34.8%)** ❌ |
| unique_products | 25,701,490 | 19,114,964 | **+6,586,526 (+34.5%)** ❌ |
| workers | 8 | 4 | **不一致** ❌ |
| max_sites_per_mol | -1 | ? | **可能不同** ❌ |

**问题**:
- workers数量不同（8 vs 4）
- 可能max_sites配置不同
- 运行时间相差7小时

---

## 预期结果（一致配置）

基于1X库的验证，预测2X-NH2重跑后：

### 乐观预测（完全一致）

| 指标 | OMe | NH2 (新) | 预期差异 |
|------|-----|----------|----------|
| total_processed | 26,984,387 | **~26,984,387** | **<1%** |
| unique_products | 25,701,490 | **~25,000,000** | **<5%** |

**理由**:
- 1X库证明：相同配置 → 相同 total_processed
- 化学反应本身无差异（小样本测试确认）

### 保守预测（考虑去重坍缩）

| 指标 | OMe | NH2 (新) | 预期差异 |
|------|-----|----------|----------|
| total_processed | 26,984,387 | **~26,984,387** | **<1%** |
| unique_products | 25,701,490 | **~24,000,000-25,000,000** | **<7%** |

**理由**:
- total_processed应该一致（反应枚举相同）
- unique_products可能略低（NH2的InChIKey坍缩更强）
- 旧数据中NH2的去重率11.15% vs OMe的0.84%

---

## 判断标准

### ✅ 成功指标

- total_processed差异 < 2%
- unique_products差异 < 10%（考虑化学坍缩）
- 配置完全一致（workers=8, max_sites=-1）

### ❌ 需要继续调查

- total_processed差异 > 5%
  → 说明还有其他运行时差异
- unique_products差异 > 15%
  → 说明去重逻辑或化学问题

---

## 对比参考（旧 vs 新）

### 旧NH2（workers=4，可能max_sites=4）
- total_processed: 20,023,649
- unique_products: 19,114,964
- 去重率: 4.54%

### 新NH2（workers=8，max_sites=-1）预期
- total_processed: **~27,000,000** (+35%)
- unique_products: **~24,500,000** (+28%)
- 去重率: **~9%** (正常范围)

---

## 下一步

1. **等待2X-NH2完成**（预计2-3小时）
2. **对比SUMMARY.json**
3. **如果差异<5%**: 问题解决 ✅
4. **如果差异仍然>10%**: 需要进一步调查运行环境或RDKit版本差异
